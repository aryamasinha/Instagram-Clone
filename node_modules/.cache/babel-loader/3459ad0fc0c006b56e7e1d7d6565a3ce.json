{"ast":null,"code":"import _slicedToArray from\"/home/aryama/Instagram-Clone/instagram-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Button}from'@material-ui/core';import{storage,db}from'./firebase';import firebase from\"firebase\";import'./ImageUpload.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ImageUpload(_ref){var username=_ref.username;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setImage=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),progress=_useState4[0],setProgress=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),caption=_useState6[0],setCaption=_useState6[1];var handleChange=function handleChange(e){if(e.target.files[0]){setImage(e.target.files[0]);}};var handleUpload=function handleUpload(){var uploadTask=storage.ref(\"images/\".concat(image.name)).put(image);uploadTask.on(\"state_changed\",function(snapshot){var progress=Math.round(snapshot.bytesTransferred/snapshot.totalBytes*100);setProgress(progress);},function(error){console.log(error);},function(){storage.ref(\"images\").child(image.name).getDownloadURL().then(function(url){db.collection(\"posts\").add({timestamp:firebase.firestore.FieldValue.serverTimestamp(),caption:caption,imageUrl:url,username:username});setProgress(0);setCaption(\"\");setImage(null);});});};return/*#__PURE__*/_jsxs(\"div\",{className:\"imageUpload\",children:[/*#__PURE__*/_jsx(\"progress\",{className:\"imageUpload__progress\",value:progress,max:\"100\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter a caption..\",onChange:function onChange(event){return setCaption(event.target.value);},value:caption}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:handleChange}),/*#__PURE__*/_jsx(Button,{onClick:handleUpload,children:\"Upload\"})]});}export default ImageUpload;","map":{"version":3,"sources":["/home/aryama/Instagram-Clone/instagram-clone/src/ImageUpload.js"],"names":["React","useState","useEffect","Button","storage","db","firebase","ImageUpload","username","image","setImage","progress","setProgress","caption","setCaption","handleChange","e","target","files","handleUpload","uploadTask","ref","name","put","on","snapshot","Math","round","bytesTransferred","totalBytes","error","console","log","child","getDownloadURL","then","url","collection","add","timestamp","firestore","FieldValue","serverTimestamp","imageUrl","event","value"],"mappings":"mKAAA,MAAOA,CAAAA,KAAP,EAAiBC,QAAjB,CAA2BC,SAA3B,KAA2C,OAA3C,CACA,OAASC,MAAT,KAAuB,mBAAvB,CACA,OAASC,OAAT,CAAkBC,EAAlB,KAA4B,YAA5B,CACA,MAAOC,CAAAA,QAAP,KAAqB,UAArB,CACA,MAAO,mBAAP,C,wFAEA,QAASC,CAAAA,WAAT,MAAiC,IAAXC,CAAAA,QAAW,MAAXA,QAAW,eACJP,QAAQ,CAAC,IAAD,CADJ,wCACtBQ,KADsB,eAChBC,QADgB,8BAEET,QAAQ,CAAC,CAAD,CAFV,yCAEtBU,QAFsB,eAEbC,WAFa,8BAGAX,QAAQ,CAAC,EAAD,CAHR,yCAGtBY,OAHsB,eAGdC,UAHc,eAK7B,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,CAAD,CAAO,CAC1B,GAAIA,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAJ,CAAsB,CAClBR,QAAQ,CAACM,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAR,CACH,CACF,CAJD,CAOA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAI,CACrB,GAAMC,CAAAA,UAAU,CAAGhB,OAAO,CAACiB,GAAR,kBAAsBZ,KAAK,CAACa,IAA5B,GAAoCC,GAApC,CAAwCd,KAAxC,CAAnB,CAEAW,UAAU,CAACI,EAAX,CACI,eADJ,CAEI,SAACC,QAAD,CAAa,CACT,GAAMd,CAAAA,QAAQ,CAAGe,IAAI,CAACC,KAAL,CACZF,QAAQ,CAACG,gBAAT,CAA4BH,QAAQ,CAACI,UAAtC,CAAoD,GADvC,CAAjB,CAGAjB,WAAW,CAACD,QAAD,CAAX,CACH,CAPL,CAQI,SAACmB,KAAD,CAAU,CACNC,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACH,CAVL,CAWI,UAAK,CACD1B,OAAO,CACNiB,GADD,CACK,QADL,EAECY,KAFD,CAEOxB,KAAK,CAACa,IAFb,EAGCY,cAHD,GAICC,IAJD,CAIM,SAAAC,GAAG,CAAG,CACR/B,EAAE,CAACgC,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2B,CACvBC,SAAS,CAAEjC,QAAQ,CAACkC,SAAT,CAAmBC,UAAnB,CAA8BC,eAA9B,EADY,CAEvB7B,OAAO,CAACA,OAFe,CAGvB8B,QAAQ,CAAGP,GAHY,CAIvB5B,QAAQ,CAACA,QAJc,CAA3B,EAMAI,WAAW,CAAC,CAAD,CAAX,CACAE,UAAU,CAAC,EAAD,CAAV,CACAJ,QAAQ,CAAC,IAAD,CAAR,CACH,CAdD,EAeH,CA3BL,EA6BH,CAhCD,CAiCA,mBACI,aAAK,SAAS,CAAC,aAAf,wBACI,iBAAU,SAAS,CAAC,uBAApB,CAA4C,KAAK,CAAEC,QAAnD,CAA6D,GAAG,CAAC,KAAjE,EADJ,cAEI,cAAO,IAAI,CAAC,MAAZ,CAAmB,WAAW,CAAC,mBAA/B,CAAmD,QAAQ,CAAE,kBAAAiC,KAAK,QAAI9B,CAAAA,UAAU,CAAC8B,KAAK,CAAC3B,MAAN,CAAa4B,KAAd,CAAd,EAAlE,CAAsG,KAAK,CAAEhC,OAA7G,EAFJ,cAGI,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAEE,YAA7B,EAHJ,cAII,KAAC,MAAD,EAAQ,OAAO,CAAEI,YAAjB,oBAJJ,GADJ,CAUH,CAED,cAAeZ,CAAAA,WAAf","sourcesContent":["import React , { useState ,useEffect} from 'react';\nimport { Button } from '@material-ui/core';\nimport { storage, db } from './firebase';\nimport firebase from \"firebase\";\nimport './ImageUpload.css';\n\nfunction ImageUpload({username}) {\n    const [image,setImage] = useState(null);\n    const [progress,setProgress] = useState(0);\n    const [caption,setCaption] = useState('');\n\n    const handleChange = (e) => {\n      if (e.target.files[0]){\n          setImage(e.target.files[0]);\n      }  \n    };\n\n    \n    const handleUpload = ()=>{\n        const uploadTask = storage.ref(`images/${image.name}`).put(image);\n\n        uploadTask.on(\n            \"state_changed\",\n            (snapshot) =>{\n                const progress = Math.round(\n                    (snapshot.bytesTransferred / snapshot.totalBytes) * 100\n                );\n                setProgress(progress);\n            },\n            (error) =>{\n                console.log(error);\n            },\n            () =>{\n                storage\n                .ref(\"images\")\n                .child(image.name)\n                .getDownloadURL()\n                .then(url =>{\n                    db.collection(\"posts\").add({\n                        timestamp: firebase.firestore.FieldValue.serverTimestamp(),\n                        caption:caption,\n                        imageUrl : url,\n                        username:username\n                    });\n                    setProgress(0);\n                    setCaption(\"\");\n                    setImage(null);\n                })\n            }\n        )\n    }\n    return (\n        <div className=\"imageUpload\">\n            <progress className=\"imageUpload__progress\" value={progress} max=\"100\"/>\n            <input type=\"text\" placeholder=\"Enter a caption..\" onChange={event => setCaption(event.target.value)} value={caption}/>\n            <input type=\"file\" onChange={handleChange}/>\n            <Button onClick={handleUpload}>\n                Upload\n            </Button>\n        </div>\n    )\n}\n\nexport default ImageUpload\n"]},"metadata":{},"sourceType":"module"}